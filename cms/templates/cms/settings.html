{% extends 'cms/base.html' %}

{% block title %}Site Settings - NageshCare CMS{% endblock %}

{% block extra_css %}
<style>
    .nav-tabs .nav-link {
        color: var(--cms-text-muted);
        border: 1px solid transparent;
        border-bottom: none;
    }

    .nav-tabs .nav-link:hover {
        color: var(--cms-primary);
        background: var(--cms-bg-light);
    }

    .nav-tabs .nav-link.active {
        color: var(--cms-primary);
        border-color: var(--cms-border) var(--cms-border) white;
        font-weight: 500;
    }

    .tab-content {
        border: 1px solid var(--cms-border);
        border-top: none;
        padding: 1.5rem;
        background: white;
        border-radius: 0 0 8px 8px;
    }

    .form-actions {
        display: flex;
        gap: 0.5rem;
        justify-content: flex-end;
        margin-top: 1.5rem;
        padding-top: 1.5rem;
        border-top: 1px solid var(--cms-border);
    }

    .form-section-title {
        font-size: 1rem;
        font-weight: 600;
        color: var(--cms-primary);
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid var(--cms-border);
    }
</style>
{% endblock %}

{% block content %}
<div class="cms-container">
    <!-- Page Header -->
    <div class="page-header">
        <h1><i class="bi bi-gear me-2"></i>Site Settings</h1>
        <p class="text-muted mb-0">Manage your website's global settings and information</p>
    </div>

    <!-- Settings Form -->
    <div class="cms-card">
        <form method="post" action="{% url 'cms:settings' %}">
            {% csrf_token %}

            <!-- Tabs Navigation -->
            <ul class="nav nav-tabs" id="settingsTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="business-tab" data-bs-toggle="tab" data-bs-target="#business" type="button" role="tab">
                        <i class="bi bi-building me-1"></i>Business Info
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab">
                        <i class="bi bi-telephone me-1"></i>Contact
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="address-tab" data-bs-toggle="tab" data-bs-target="#address" type="button" role="tab">
                        <i class="bi bi-geo-alt me-1"></i>Address
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="social-tab" data-bs-toggle="tab" data-bs-target="#social" type="button" role="tab">
                        <i class="bi bi-share me-1"></i>Social Media
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="business-details-tab" data-bs-toggle="tab" data-bs-target="#business-details" type="button" role="tab">
                        <i class="bi bi-briefcase me-1"></i>Business Details
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="seo-tab" data-bs-toggle="tab" data-bs-target="#seo" type="button" role="tab">
                        <i class="bi bi-search me-1"></i>SEO
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="email-tab" data-bs-toggle="tab" data-bs-target="#email" type="button" role="tab">
                        <i class="bi bi-envelope-at me-1"></i>Email
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="whatsapp-tab" data-bs-toggle="tab" data-bs-target="#whatsapp" type="button" role="tab">
                        <i class="bi bi-whatsapp me-1"></i>WhatsApp Float
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="theme-tab" data-bs-toggle="tab" data-bs-target="#theme" type="button" role="tab">
                        <i class="bi bi-palette me-1"></i>Theme
                    </button>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content" id="settingsTabContent">

                <!-- Business Information Tab -->
                <div class="tab-pane fade show active" id="business" role="tabpanel">
                    <div class="form-section-title">Business Information</div>

                    <div class="mb-3">
                        <label class="form-label">Business Name <span class="text-danger">*</span></label>
                        <input type="text" name="business_name" class="form-control" value="{{ settings.business_name }}" required>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Tagline</label>
                        <input type="text" name="tagline" class="form-control" value="{{ settings.tagline|default:'' }}" placeholder="Your trusted partner in quality products">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Business Description</label>
                        <textarea name="business_description" class="form-control" rows="4">{{ settings.business_description|default:'' }}</textarea>
                        <small class="text-muted">Brief description of your business</small>
                    </div>
                </div>

                <!-- Contact Information Tab -->
                <div class="tab-pane fade" id="contact" role="tabpanel">
                    <div class="form-section-title">Contact Information</div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Primary Phone <span class="text-danger">*</span></label>
                            <input type="tel" name="phone_primary" class="form-control" value="{{ settings.phone_primary }}" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">WhatsApp Number</label>
                            <input type="tel" name="phone_whatsapp" class="form-control" value="{{ settings.phone_whatsapp|default:'' }}">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Primary Email <span class="text-danger">*</span></label>
                            <input type="email" name="email_primary" class="form-control" value="{{ settings.email_primary }}" required>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Support Email</label>
                            <input type="email" name="email_support" class="form-control" value="{{ settings.email_support|default:'' }}">
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Sales Email</label>
                        <input type="email" name="email_sales" class="form-control" value="{{ settings.email_sales|default:'' }}">
                    </div>

                    <div class="form-section-title mt-4">Business Hours</div>

                    <div class="mb-3">
                        <label class="form-label">Business Hours</label>
                        <input type="text" name="business_hours" class="form-control" value="{{ settings.business_hours|default:'' }}" placeholder="Mon-Sat: 9:00 AM - 6:00 PM">
                        <small class="text-muted">Displayed in the top header bar</small>
                    </div>
                </div>

                <!-- Address Tab -->
                <div class="tab-pane fade" id="address" role="tabpanel">
                    <div class="form-section-title">Business Address</div>

                    <div class="mb-3">
                        <label class="form-label">Address Line 1</label>
                        <input type="text" name="address_line1" class="form-control" value="{{ settings.address_line1|default:'' }}">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Address Line 2</label>
                        <input type="text" name="address_line2" class="form-control" value="{{ settings.address_line2|default:'' }}">
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">City</label>
                            <input type="text" name="city" class="form-control" value="{{ settings.city|default:'' }}">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">State/Province</label>
                            <input type="text" name="state" class="form-control" value="{{ settings.state|default:'' }}">
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Postal Code / Pincode</label>
                        <input type="text" name="pincode" class="form-control" value="{{ settings.pincode|default:'' }}" placeholder="e.g., 400001">
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Google Maps Embed URL</label>
                        <input type="url" name="map_embed_url" class="form-control" value="{{ settings.map_embed_url|default:'' }}">
                        <small class="text-muted">Full iframe embed URL from Google Maps</small>
                    </div>
                </div>

                <!-- Social Media Tab -->
                <div class="tab-pane fade" id="social" role="tabpanel">
                    <div class="form-section-title">Social Media Links</div>
                    <p class="text-muted small mb-4">Enter full URLs for your social media profiles. These will appear in the footer.</p>

                    <div class="mb-3">
                        <label class="form-label"><i class="bi bi-facebook text-primary me-2"></i>Facebook</label>
                        <input type="url" name="facebook_url" class="form-control" value="{{ settings.facebook_url|default:'' }}" placeholder="https://facebook.com/yourpage">
                    </div>

                    <div class="mb-3">
                        <label class="form-label"><i class="bi bi-instagram text-danger me-2"></i>Instagram</label>
                        <input type="url" name="instagram_url" class="form-control" value="{{ settings.instagram_url|default:'' }}" placeholder="https://instagram.com/yourhandle">
                    </div>

                    <div class="mb-3">
                        <label class="form-label"><i class="bi bi-linkedin text-primary me-2"></i>LinkedIn</label>
                        <input type="url" name="linkedin_url" class="form-control" value="{{ settings.linkedin_url|default:'' }}" placeholder="https://linkedin.com/company/yourcompany">
                    </div>

                    <div class="mb-3">
                        <label class="form-label"><i class="bi bi-whatsapp text-success me-2"></i>WhatsApp</label>
                        <input type="url" name="whatsapp_url" class="form-control" value="{{ settings.whatsapp_url|default:'' }}" placeholder="https://wa.me/919876543210">
                        <small class="text-muted">Format: https://wa.me/[country code][phone number]</small>
                    </div>
                </div>

                <!-- Business Details Tab -->
                <div class="tab-pane fade" id="business-details" role="tabpanel">
                    <div class="form-section-title">Business Details</div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">GST Number</label>
                            <input type="text" name="gst_number" class="form-control" value="{{ settings.gst_number|default:'' }}" placeholder="e.g., 27XXXXX0000X1Z5">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">CIN Number</label>
                            <input type="text" name="cin_number" class="form-control" value="{{ settings.cin_number|default:'' }}" placeholder="e.g., U12345AB1234PLC123456">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">MSME Registration Number</label>
                            <input type="text" name="msme_number" class="form-control" value="{{ settings.msme_number|default:'' }}" placeholder="MSME Registration Number">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Year Established</label>
                            <input type="text" name="established_year" class="form-control" value="{{ settings.established_year|default:'' }}" placeholder="2010" maxlength="4">
                            <small class="text-muted">4-digit year</small>
                        </div>
                    </div>
                </div>

                <!-- SEO Tab -->
                <div class="tab-pane fade" id="seo" role="tabpanel">
                    <div class="form-section-title">Default SEO Settings</div>
                    <p class="text-muted small mb-4">These defaults will be used on pages that don't have specific SEO meta tags set.</p>

                    <div class="mb-3">
                        <label class="form-label">Default Meta Description</label>
                        <textarea name="default_meta_description" class="form-control" rows="3">{{ settings.default_meta_description|default:'' }}</textarea>
                        <small class="text-muted">Used when page doesn't have a specific meta description (recommended: 120-160 characters)</small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Default Meta Keywords</label>
                        <input type="text" name="default_meta_keywords" class="form-control" value="{{ settings.default_meta_keywords|default:'' }}">
                        <small class="text-muted">Comma-separated keywords (e.g., wholesale, trading, personal care)</small>
                    </div>
                </div>

                <!-- Email Settings Tab -->
                <div class="tab-pane fade" id="email" role="tabpanel">
                    <div class="form-section-title">SMTP Email Configuration</div>
                    <p class="text-muted small mb-4">Configure email settings for sending inquiry replies. These settings are used when replying to contact messages and quote requests from the CMS.</p>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">SMTP Host <span class="text-danger">*</span></label>
                            <input type="text" name="email_host" class="form-control" value="{{ settings.email_host|default:'smtp.gmail.com' }}" placeholder="smtp.gmail.com">
                            <small class="text-muted">Your email provider's SMTP server</small>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">SMTP Port <span class="text-danger">*</span></label>
                            <input type="number" name="email_port" class="form-control" value="{{ settings.email_port|default:'587' }}" placeholder="587">
                            <small class="text-muted">587 for TLS, 465 for SSL</small>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">SMTP Username/Email <span class="text-danger">*</span></label>
                            <input type="email" name="email_host_user" class="form-control" value="{{ settings.email_host_user|default:'' }}" placeholder="your-email@example.com">
                            <small class="text-muted">Email address to send from</small>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">SMTP Password <span class="text-danger">*</span></label>
                            <input type="password" name="email_host_password" class="form-control" value="{{ settings.email_host_password|default:'' }}" placeholder="••••••••">
                            <small class="text-muted">App password or SMTP password</small>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="form-check">
                            <input type="checkbox" name="email_use_tls" class="form-check-input" id="emailUseTLS" {% if settings.email_use_tls %}checked{% endif %} value="1">
                            <label class="form-check-label" for="emailUseTLS">
                                Use TLS Encryption
                            </label>
                            <small class="form-text text-muted d-block">Enable TLS for secure email transmission (recommended for port 587)</small>
                        </div>
                    </div>

                    <div class="form-section-title mt-4">Email Signature</div>

                    <div class="mb-3">
                        <label class="form-label">Reply Signature</label>
                        <textarea name="email_reply_signature" class="form-control" rows="4" placeholder="Best regards,&#10;NageshCare Team&#10;www.nageshcare.com">{{ settings.email_reply_signature|default:'Best regards,\nNageshCare Team\nwww.nageshcare.com' }}</textarea>
                        <small class="text-muted">This signature will be automatically added to all email replies</small>
                    </div>

                    <div class="alert alert-info">
                        <strong><i class="bi bi-info-circle me-2"></i>Gmail Users:</strong>
                        <p class="mb-0">If using Gmail, you'll need to create an "App Password" instead of using your regular Gmail password. Go to your Google Account settings > Security > 2-Step Verification > App passwords to generate one.</p>
                    </div>

                    <div class="alert alert-warning">
                        <strong><i class="bi bi-exclamation-triangle me-2"></i>Important:</strong>
                        <p class="mb-0">These settings are required for sending email replies from the inquiry management system. Without proper SMTP configuration, email replies will fail.</p>
                    </div>
                </div>

                <!-- WhatsApp Float Tab -->
                <div class="tab-pane fade" id="whatsapp" role="tabpanel">
                    <div class="form-section-title">WhatsApp Floating Button Settings</div>
                    <p class="text-muted small mb-4">Configure the floating WhatsApp button that appears on your website. This provides quick access for visitors to contact you.</p>

                    <div class="mb-3">
                        <div class="form-check form-switch">
                            <input type="checkbox" name="whatsapp_float_enabled" class="form-check-input" id="whatsappFloatEnabled" {% if settings.whatsapp_float_enabled %}checked{% endif %} value="1">
                            <label class="form-check-label" for="whatsappFloatEnabled">
                                <strong>Enable Floating WhatsApp Button</strong>
                            </label>
                            <small class="form-text text-muted d-block">Show/hide the floating WhatsApp icon on your website</small>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">WhatsApp Number <span class="text-danger">*</span></label>
                        <input type="tel" name="phone_whatsapp" class="form-control" value="{{ settings.phone_whatsapp|default:'' }}" placeholder="+91 876 473 3777">
                        <small class="text-muted">Enter with country code (e.g., +91 876 473 3777). Spaces, + and - will be automatically removed for the link.</small>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Default WhatsApp Message</label>
                        <textarea name="whatsapp_float_message" class="form-control" rows="3" placeholder="Hi, I'm interested in your wholesale products. Please share more details.">{{ settings.whatsapp_float_message|default:"Hi, I'm interested in your wholesale products. Please share more details." }}</textarea>
                        <small class="text-muted">This message will be pre-filled when visitors click the WhatsApp button</small>
                    </div>

                    <div class="form-section-title mt-4">Display Settings</div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="form-check">
                                <input type="checkbox" name="whatsapp_float_show_on_desktop" class="form-check-input" id="whatsappShowDesktop" {% if settings.whatsapp_float_show_on_desktop %}checked{% endif %} value="1">
                                <label class="form-check-label" for="whatsappShowDesktop">
                                    Show on Desktop/Tablet
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="form-check">
                                <input type="checkbox" name="whatsapp_float_show_on_mobile" class="form-check-input" id="whatsappShowMobile" {% if settings.whatsapp_float_show_on_mobile %}checked{% endif %} value="1">
                                <label class="form-check-label" for="whatsappShowMobile">
                                    Show on Mobile Devices
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-section-title mt-4">Position Settings</div>
                    <p class="text-muted small mb-3">Adjust the position of the floating button from the bottom and right edges of the screen (in pixels)</p>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Bottom Position (pixels)</label>
                            <input type="number" name="whatsapp_float_position_bottom" class="form-control" value="{{ settings.whatsapp_float_position_bottom|default:100 }}" min="0" max="500">
                            <small class="text-muted">Distance from bottom of screen (default: 100px)</small>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Right Position (pixels)</label>
                            <input type="number" name="whatsapp_float_position_right" class="form-control" value="{{ settings.whatsapp_float_position_right|default:20 }}" min="0" max="200">
                            <small class="text-muted">Distance from right edge (default: 20px)</small>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <strong><i class="bi bi-info-circle me-2"></i>Note:</strong>
                        <p class="mb-0">The WhatsApp number entered here will be used for both the floating button and other WhatsApp links throughout your website. Make sure to include the country code.</p>
                    </div>

                    <div class="alert alert-success">
                        <strong><i class="bi bi-lightbulb me-2"></i>Preview:</strong>
                        <p class="mb-2">The floating WhatsApp button will appear as a green circular icon with the WhatsApp logo. It includes:</p>
                        <ul class="mb-0">
                            <li>Smooth pulse animation to attract attention</li>
                            <li>Hover effect with scale and color change</li>
                            <li>Opens WhatsApp chat with your pre-filled message</li>
                        </ul>
                    </div>
                </div>

                <!-- Theme Tab -->
                <div class="tab-pane fade" id="theme" role="tabpanel">
                    <div class="form-section-title">Theme Customization</div>
                    <p class="text-muted small mb-4">Load a pre-configured color palette as a starting point, then customize any colors to match your brand.</p>

                    <!-- Palette Presets -->
                    <div class="mb-4">
                        <label class="form-label fw-bold">Pre-configured Color Palettes</label>
                        <p class="text-muted small">Click "Load Palette" to populate the form with preset colors. You can then customize any field before saving.</p>
                        <div class="row g-3">
                            <div class="col-md-4">
                                <div class="card h-100 border">
                                    <div class="card-body">
                                        <h6 class="card-title fw-bold mb-2">Default (Teal & Golden)</h6>
                                        <div class="d-flex gap-1 mb-3">
                                            <div style="width:30px;height:30px;background:#264653;border-radius:4px;"></div>
                                            <div style="width:30px;height:30px;background:#E9C46A;border-radius:4px;"></div>
                                            <div style="width:30px;height:30px;background:#2A9D8F;border-radius:4px;"></div>
                                            <div style="width:30px;height:30px;background:#F4A261;border-radius:4px;"></div>
                                        </div>
                                        <button type="button" class="btn btn-outline-primary btn-sm w-100" onclick="loadPalette('default')">
                                            <i class="bi bi-download me-1"></i>Load Palette
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card h-100 border">
                                    <div class="card-body">
                                        <h6 class="card-title fw-bold mb-2">Nature (Forest & Cream)</h6>
                                        <div class="d-flex gap-1 mb-3">
                                            <div style="width:30px;height:30px;background:#0A5F45;border-radius:4px;"></div>
                                            <div style="width:30px;height:30px;background:#FEECD7;border-radius:4px;"></div>
                                            <div style="width:30px;height:30px;background:#2E8B57;border-radius:4px;"></div>
                                            <div style="width:30px;height:30px;background:#F5E6D3;border-radius:4px;"></div>
                                        </div>
                                        <button type="button" class="btn btn-outline-success btn-sm w-100" onclick="loadPalette('nature')">
                                            <i class="bi bi-download me-1"></i>Load Palette
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card h-100 border">
                                    <div class="card-body">
                                        <h6 class="card-title fw-bold mb-2">Professional (Dark & Gray)</h6>
                                        <div class="d-flex gap-1 mb-3">
                                            <div style="width:30px;height:30px;background:#19272B;border-radius:4px;"></div>
                                            <div style="width:30px;height:30px;background:#AFC1C5;border-radius:4px;"></div>
                                            <div style="width:30px;height:30px;background:#4F595E;border-radius:4px;"></div>
                                            <div style="width:30px;height:30px;background:#233036;border-radius:4px;"></div>
                                        </div>
                                        <button type="button" class="btn btn-outline-secondary btn-sm w-100" onclick="loadPalette('professional')">
                                            <i class="bi bi-download me-1"></i>Load Palette
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Hidden input for active_palette -->
                    <input type="hidden" name="active_palette" value="custom">

                    <!-- Core Colors Section -->
                    <div class="form-section-title mt-4">Core Brand Colors</div>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Primary Color</label>
                            <input type="color" name="primary_color" class="form-control form-control-color w-100" value="{{ theme.primary_color }}">
                            <small class="text-muted">Main brand color</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Primary Hover</label>
                            <input type="color" name="primary_hover" class="form-control form-control-color w-100" value="{{ theme.primary_hover }}">
                            <small class="text-muted">Hover state</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Secondary Color</label>
                            <input type="color" name="secondary_color" class="form-control form-control-color w-100" value="{{ theme.secondary_color }}">
                            <small class="text-muted">Accent color</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Secondary Hover</label>
                            <input type="color" name="secondary_hover" class="form-control form-control-color w-100" value="{{ theme.secondary_hover }}">
                            <small class="text-muted">Hover state</small>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Accent Color</label>
                            <input type="color" name="accent_color" class="form-control form-control-color w-100" value="{{ theme.accent_color }}">
                            <small class="text-muted">Badges, highlights</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Light Background</label>
                            <input type="color" name="background_light" class="form-control form-control-color w-100" value="{{ theme.background_light }}">
                            <small class="text-muted">Section backgrounds</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Dark Background</label>
                            <input type="color" name="background_dark" class="form-control form-control-color w-100" value="{{ theme.background_dark }}">
                            <small class="text-muted">Footer, dark sections</small>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Primary Text</label>
                            <input type="color" name="text_primary" class="form-control form-control-color w-100" value="{{ theme.text_primary }}">
                            <small class="text-muted">Body text</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Secondary Text</label>
                            <input type="color" name="text_secondary" class="form-control form-control-color w-100" value="{{ theme.text_secondary }}">
                            <small class="text-muted">Muted text</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Light Border</label>
                            <input type="color" name="border_light" class="form-control form-control-color w-100" value="{{ theme.border_light }}">
                            <small class="text-muted">Subtle borders</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Medium Border</label>
                            <input type="color" name="border_medium" class="form-control form-control-color w-100" value="{{ theme.border_medium }}">
                            <small class="text-muted">Standard borders</small>
                        </div>
                    </div>

                    <!-- Header & Navigation Colors Section -->
                    <div class="form-section-title mt-4">Header & Navigation Colors</div>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Top Bar Background</label>
                            <input type="color" name="topbar_bg" class="form-control form-control-color w-100" value="{{ theme.topbar_bg }}">
                            <small class="text-muted">Info bar background</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Top Bar Text</label>
                            <input type="color" name="topbar_text" class="form-control form-control-color w-100" value="{{ theme.topbar_text }}">
                            <small class="text-muted">Top bar text color</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Top Bar Link</label>
                            <input type="color" name="topbar_link" class="form-control form-control-color w-100" value="{{ theme.topbar_link }}">
                            <small class="text-muted">Top bar link color</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Top Bar Link Hover</label>
                            <input type="color" name="topbar_link_hover" class="form-control form-control-color w-100" value="{{ theme.topbar_link_hover }}">
                            <small class="text-muted">Hover state</small>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Navbar Background</label>
                            <input type="color" name="navbar_bg" class="form-control form-control-color w-100" value="{{ theme.navbar_bg }}">
                            <small class="text-muted">Main nav background</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Navbar Link</label>
                            <input type="color" name="navbar_link" class="form-control form-control-color w-100" value="{{ theme.navbar_link }}">
                            <small class="text-muted">Nav link color</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Navbar Link Hover</label>
                            <input type="color" name="navbar_link_hover" class="form-control form-control-color w-100" value="{{ theme.navbar_link_hover }}">
                            <small class="text-muted">Nav hover state</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Navbar Link Active</label>
                            <input type="color" name="navbar_link_active" class="form-control form-control-color w-100" value="{{ theme.navbar_link_active }}">
                            <small class="text-muted">Active nav item</small>
                        </div>
                    </div>

                    <!-- Content & Text Colors Section -->
                    <div class="form-section-title mt-4">Content & Text Colors</div>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Section Subtitle</label>
                            <input type="color" name="section_subtitle" class="form-control form-control-color w-100" value="{{ theme.section_subtitle }}">
                            <small class="text-muted">Eyebrow text color</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Muted Text</label>
                            <input type="color" name="text_muted" class="form-control form-control-color w-100" value="{{ theme.text_muted }}">
                            <small class="text-muted">Helper/muted text</small>
                        </div>
                    </div>

                    <!-- Icon Colors Section -->
                    <div class="form-section-title mt-4">Icon Colors</div>
                    <p class="text-muted small">Note: Social media icons (Facebook, Instagram, LinkedIn, WhatsApp) will always use their official brand colors.</p>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Default Icon</label>
                            <input type="color" name="icon_default" class="form-control form-control-color w-100" value="{{ theme.icon_default }}">
                            <small class="text-muted">General icons</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Icon Hover</label>
                            <input type="color" name="icon_hover" class="form-control form-control-color w-100" value="{{ theme.icon_hover }}">
                            <small class="text-muted">Icon hover state</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Feature Icons</label>
                            <input type="color" name="icon_feature" class="form-control form-control-color w-100" value="{{ theme.icon_feature }}">
                            <small class="text-muted">Feature card icons</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Trust Badge Icons</label>
                            <input type="color" name="icon_trust" class="form-control form-control-color w-100" value="{{ theme.icon_trust }}">
                            <small class="text-muted">Trust indicators</small>
                        </div>
                    </div>

                    <!-- Footer Colors Section -->
                    <div class="form-section-title mt-4">Footer Colors</div>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Footer Background</label>
                            <input type="color" name="footer_bg" class="form-control form-control-color w-100" value="{{ theme.footer_bg }}">
                            <small class="text-muted">Footer background</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Footer Heading</label>
                            <input type="color" name="footer_heading" class="form-control form-control-color w-100" value="{{ theme.footer_heading }}">
                            <small class="text-muted">Footer section titles</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Footer Text</label>
                            <input type="color" name="footer_text" class="form-control form-control-color w-100" value="{{ theme.footer_text }}">
                            <small class="text-muted">Footer body text</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Footer Link</label>
                            <input type="color" name="footer_link" class="form-control form-control-color w-100" value="{{ theme.footer_link }}">
                            <small class="text-muted">Footer link color</small>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Footer Link Hover</label>
                            <input type="color" name="footer_link_hover" class="form-control form-control-color w-100" value="{{ theme.footer_link_hover }}">
                            <small class="text-muted">Footer link hover</small>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label class="form-label">Footer Icon</label>
                            <input type="color" name="footer_icon" class="form-control form-control-color w-100" value="{{ theme.footer_icon }}">
                            <small class="text-muted">Footer icon color</small>
                        </div>
                    </div>

                    <!-- Typography Section -->
                    <div class="form-section-title mt-4">Typography</div>

                        <div class="row">
                            <div class="col-md-3 mb-3">
                                <label class="form-label">Heading Font</label>
                                <select name="font_heading" class="form-select">
                                    <option value="Inter" {% if theme.font_heading == 'Inter' %}selected{% endif %}>Inter</option>
                                    <option value="Roboto" {% if theme.font_heading == 'Roboto' %}selected{% endif %}>Roboto</option>
                                    <option value="DM Sans" {% if theme.font_heading == 'DM Sans' %}selected{% endif %}>DM Sans</option>
                                    <option value="Heebo" {% if theme.font_heading == 'Heebo' %}selected{% endif %}>Heebo</option>
                                    <option value="Poppins" {% if theme.font_heading == 'Poppins' %}selected{% endif %}>Poppins</option>
                                    <option value="Montserrat" {% if theme.font_heading == 'Montserrat' %}selected{% endif %}>Montserrat</option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label class="form-label">Heading Weight</label>
                                <select name="font_heading_weight" class="form-select">
                                    <option value="400" {% if theme.font_heading_weight == 400 %}selected{% endif %}>Regular (400)</option>
                                    <option value="500" {% if theme.font_heading_weight == 500 %}selected{% endif %}>Medium (500)</option>
                                    <option value="600" {% if theme.font_heading_weight == 600 %}selected{% endif %}>Semi-Bold (600)</option>
                                    <option value="700" {% if theme.font_heading_weight == 700 %}selected{% endif %}>Bold (700)</option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label class="form-label">Body Font</label>
                                <select name="font_body" class="form-select">
                                    <option value="Inter" {% if theme.font_body == 'Inter' %}selected{% endif %}>Inter</option>
                                    <option value="Roboto" {% if theme.font_body == 'Roboto' %}selected{% endif %}>Roboto</option>
                                    <option value="DM Sans" {% if theme.font_body == 'DM Sans' %}selected{% endif %}>DM Sans</option>
                                    <option value="Heebo" {% if theme.font_body == 'Heebo' %}selected{% endif %}>Heebo</option>
                                    <option value="Poppins" {% if theme.font_body == 'Poppins' %}selected{% endif %}>Poppins</option>
                                    <option value="Open Sans" {% if theme.font_body == 'Open Sans' %}selected{% endif %}>Open Sans</option>
                                </select>
                            </div>
                            <div class="col-md-3 mb-3">
                                <label class="form-label">Body Weight</label>
                                <select name="font_body_weight" class="form-select">
                                    <option value="300" {% if theme.font_body_weight == 300 %}selected{% endif %}>Light (300)</option>
                                    <option value="400" {% if theme.font_body_weight == 400 %}selected{% endif %}>Regular (400)</option>
                                    <option value="500" {% if theme.font_body_weight == 500 %}selected{% endif %}>Medium (500)</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-section-title mt-4">Spacing & Effects</div>

                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Border Radius</label>
                                <input type="text" name="border_radius" class="form-control" value="{{ theme.border_radius }}" placeholder="8px">
                                <small class="text-muted">e.g., 8px, 0.5rem</small>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Default Shadow</label>
                                <input type="text" name="box_shadow_default" class="form-control" value="{{ theme.box_shadow_default }}" placeholder="0 4px 6px rgba(0,0,0,0.08)">
                            </div>
                            <div class="col-md-4 mb-3">
                                <label class="form-label">Hover Shadow</label>
                                <input type="text" name="box_shadow_hover" class="form-control" value="{{ theme.box_shadow_hover }}" placeholder="0 8px 15px rgba(0,0,0,0.15)">
                            </div>
                        </div>
                    </div>

                    <!-- Theme Save Button -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-cms-secondary" onclick="document.getElementById('theme-form').reset();">
                            <i class="bi bi-arrow-counterclockwise me-1"></i>Reset
                        </button>
                        <button type="button" class="btn btn-cms-primary" onclick="submitThemeForm()">
                            <i class="bi bi-check-lg me-1"></i>Save Theme Settings
                        </button>
                    </div>
                </div>

            </div>

            <!-- Save Button -->
            <div class="form-actions">
                <a href="{% url 'cms:dashboard' %}" class="btn btn-cms-secondary">
                    <i class="bi bi-x-lg me-1"></i>Cancel
                </a>
                <button type="submit" class="btn btn-cms-primary">
                    <i class="bi bi-check-lg me-1"></i>Save All Settings
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// Color palette configurations
const palettes = {
    'default': {
        // Core Colors
        'primary_color': '#264653',
        'primary_hover': '#1B3540',
        'secondary_color': '#2A9D8F',
        'secondary_hover': '#21867A',
        'accent_color': '#E9C46A',
        'background_light': '#F8F9FA',
        'background_dark': '#264653',
        'text_primary': '#333333',
        'text_secondary': '#6C757D',
        'border_light': '#E0E0E0',
        'border_medium': '#CCCCCC',
        // Header - Top Bar
        'topbar_bg': '#264653',
        'topbar_text': '#FFFFFF',
        'topbar_link': '#FFFFFF',
        'topbar_link_hover': '#E9C46A',
        // Header - Navigation
        'navbar_bg': '#FFFFFF',
        'navbar_link': '#333333',
        'navbar_link_hover': '#264653',
        'navbar_link_active': '#264653',
        // Content
        'section_subtitle': '#2A9D8F',
        'text_muted': '#6C757D',
        // Icons
        'icon_default': '#264653',
        'icon_hover': '#2A9D8F',
        'icon_feature': '#264653',
        'icon_trust': '#E9C46A',
        // Footer
        'footer_bg': '#1A3540',
        'footer_heading': '#E9C46A',
        'footer_text': '#B8C5CC',
        'footer_link': '#B8C5CC',
        'footer_link_hover': '#E9C46A',
        'footer_icon': '#E9C46A',
        // Typography
        'font_heading': 'Inter',
        'font_body': 'Roboto',
        'font_heading_weight': '600',
        'font_body_weight': '400',
        // Spacing
        'border_radius': '8px',
        'box_shadow_default': '0 4px 6px rgba(0,0,0,0.08)',
        'box_shadow_hover': '0 8px 15px rgba(0,0,0,0.15)'
    },
    'nature': {
        // Core Colors
        'primary_color': '#0A5F45',
        'primary_hover': '#084B36',
        'secondary_color': '#2E8B57',
        'secondary_hover': '#256F45',
        'accent_color': '#FEECD7',
        'background_light': '#F5F5F5',
        'background_dark': '#0A5F45',
        'text_primary': '#2C2C2C',
        'text_secondary': '#666666',
        'border_light': '#E8E8E8',
        'border_medium': '#CCCCCC',
        // Header - Top Bar
        'topbar_bg': '#0A5F45',
        'topbar_text': '#FFFFFF',
        'topbar_link': '#FFFFFF',
        'topbar_link_hover': '#FEECD7',
        // Header - Navigation
        'navbar_bg': '#FFFFFF',
        'navbar_link': '#2C2C2C',
        'navbar_link_hover': '#0A5F45',
        'navbar_link_active': '#0A5F45',
        // Content
        'section_subtitle': '#2E8B57',
        'text_muted': '#666666',
        // Icons
        'icon_default': '#0A5F45',
        'icon_hover': '#2E8B57',
        'icon_feature': '#0A5F45',
        'icon_trust': '#FEECD7',
        // Footer
        'footer_bg': '#0A5F45',
        'footer_heading': '#FEECD7',
        'footer_text': '#E6E6E6',
        'footer_link': '#E6E6E6',
        'footer_link_hover': '#FEECD7',
        'footer_icon': '#FEECD7',
        // Typography
        'font_heading': 'Poppins',
        'font_body': 'Open Sans',
        'font_heading_weight': '600',
        'font_body_weight': '400',
        // Spacing
        'border_radius': '10px',
        'box_shadow_default': '0 4px 8px rgba(0,0,0,0.1)',
        'box_shadow_hover': '0 8px 16px rgba(0,0,0,0.2)'
    },
    'professional': {
        // Core Colors
        'primary_color': '#19272B',
        'primary_hover': '#101A1D',
        'secondary_color': '#4F595E',
        'secondary_hover': '#3D4649',
        'accent_color': '#AFC1C5',
        'background_light': '#F5F5F5',
        'background_dark': '#233036',
        'text_primary': '#19272B',
        'text_secondary': '#6C757D',
        'border_light': '#E0E0E0',
        'border_medium': '#CCCCCC',
        // Header - Top Bar
        'topbar_bg': '#19272B',
        'topbar_text': '#FFFFFF',
        'topbar_link': '#AFC1C5',
        'topbar_link_hover': '#FFFFFF',
        // Header - Navigation
        'navbar_bg': '#FFFFFF',
        'navbar_link': '#19272B',
        'navbar_link_hover': '#4F595E',
        'navbar_link_active': '#19272B',
        // Content
        'section_subtitle': '#4F595E',
        'text_muted': '#6C757D',
        // Icons
        'icon_default': '#19272B',
        'icon_hover': '#4F595E',
        'icon_feature': '#4F595E',
        'icon_trust': '#AFC1C5',
        // Footer
        'footer_bg': '#233036',
        'footer_heading': '#AFC1C5',
        'footer_text': '#D0D0D0',
        'footer_link': '#AFC1C5',
        'footer_link_hover': '#FFFFFF',
        'footer_icon': '#AFC1C5',
        // Typography
        'font_heading': 'DM Sans',
        'font_body': 'Heebo',
        'font_heading_weight': '700',
        'font_body_weight': '400',
        // Spacing
        'border_radius': '4px',
        'box_shadow_default': '0 2px 4px rgba(0,0,0,0.1)',
        'box_shadow_hover': '0 4px 8px rgba(0,0,0,0.15)'
    }
};

// Load palette function
function loadPalette(paletteName) {
    const palette = palettes[paletteName];
    if (!palette) {
        console.error('Palette not found:', paletteName);
        return;
    }

    // Update all form fields with palette values
    for (const [fieldName, value] of Object.entries(palette)) {
        const input = document.querySelector(`[name="${fieldName}"]`);
        if (input) {
            if (input.tagName === 'SELECT') {
                input.value = value;
            } else if (input.type === 'color') {
                input.value = value;
            } else {
                input.value = value;
            }
        }
    }

    // Show success message
    const alertDiv = document.createElement('div');
    alertDiv.className = 'alert alert-success alert-dismissible fade show mt-3';
    alertDiv.innerHTML = `
        <i class="bi bi-check-circle me-2"></i>
        <strong>${paletteName.charAt(0).toUpperCase() + paletteName.slice(1)} Palette</strong> loaded successfully!
        Review and customize the colors below, then click "Save Theme Settings" to apply.
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;

    // Insert alert at the top of the theme tab
    const themeTab = document.querySelector('#theme');
    const firstChild = themeTab.firstElementChild;
    themeTab.insertBefore(alertDiv, firstChild.nextSibling);

    // Auto-dismiss after 5 seconds
    setTimeout(() => {
        alertDiv.classList.remove('show');
        setTimeout(() => alertDiv.remove(), 150);
    }, 5000);

    // Scroll to color fields
    document.querySelector('.form-section-title').scrollIntoView({ behavior: 'smooth', block: 'start' });
}

// Submit theme form with section parameter
function submitThemeForm() {
    const form = document.querySelector('form[action="{% url 'cms:settings' %}"]');

    // Create a hidden input for section
    const sectionInput = document.createElement('input');
    sectionInput.type = 'hidden';
    sectionInput.name = 'section';
    sectionInput.value = 'theme';

    // Add it to the form
    form.appendChild(sectionInput);

    // Submit the form
    form.submit();
}
</script>
{% endblock %}
